{% extends 'InstacountInstacountBundle::layout.html.twig' %}
{% block body %}
	<div data-role="page" data-add-back-btn="true">
    	<header data-position="fixed" data-role="header">
            <h1>Instacount</h1><a href="{{ path('InstacountInstacountBundle_homepage')}}" data-transition="flip" class="ui-btn-right" data-role="button" data-icon="arrow-r" data-iconpos="right">Logga ut</a>
        </header>	
        <div class="content" data-theme="b" data-role="content">	
        	<h2>Diagram över {{ campaign.name }} (#{{ campaign.tag }}): </h2>
        	  <div id="chart_div"></div>        	
        </div>		

				
{% endblock %}
{% block javascripts %}
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>           
<script src="https://www.google.com/jsapi"></script>
<script>  
var url = "{{ path('InstacountInstacountBundle_campaign_json', {'campaign_id': campaign_id }) }}";
console.log(url);     	
google.load('visualization', '1', {'packages':['corechart']});
google.setOnLoadCallback(drawChart);
function drawChart() {   	
	var jsonData = $.ajax({
		url: url,
		dataType:"json",
		async: false
	}).responseText;
	var data = new google.visualization.DataTable(jsonData);
	var options = {
		width: 320, height: 480,
		title: "Antal tags för #{{ campaign.tag }} under perioden {{ campaign.startDate|date('Y-m-d') }} - {{ 'now'|date('Y-m-d') }}"
	};
	var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
	chart.draw(data, options);
}
</script>
{% endblock %}